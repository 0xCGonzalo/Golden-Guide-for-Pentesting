Archivos que contienen contraseñas:

Se realiza la búsqueda entre los ficheros del sistema y se analiza los resultados obtenidos con el fin de identificar contraseña que se encuentren embebidas en scripts y ficheros de configuración. Para ello, se ejecuta el comando listado a continuación.

grep --color=auto -rnw '/' -ie "PASSWORD" --color=always 2> /dev/null

Últimos archivos editados:

Se realiza una búsqueda de los ficheros editados recientemente y se analiza los resultados obtenidos. Para esta tarea, se ejecuta el comando listado a continuación.

find / -mmin -10 2>/dev/null | grep -Ev "^/proc"

Contraseñas en memoria:

El siguiente paso, es intentar extraer contraseñas residentes en memoria. Para ello, se realiza una búsqueda de cadenas de caracteres que contengan la palabra PASS dentro de /dev/mem. A continuación, se lista el comando ejecutado para este análisis:

strings /dev/mem -n10 | grep -i PASS

Fuga de información en ficheros sensibles:

locate password | more
/boot/grub/i386-pc/password.mod
/etc/pam.d/common-password
/etc/pam.d/gdm-password
/etc/pam.d/gdm-password.original

Tareas Programadas:

Con el fin de elevar privilegios dentro del sistema, se intenta identificar ficheros sobre los cuales se tenga permisos de escritura con el usuario usrentlgy. Estos ficheros, se encuentran normalmente relacionados con el manejo de tareas programadas y manejo de permisos de usuarios. A continuación, se presenta una lista de los ficheros auditados:

/etc/init.d
/etc/cron*
/etc/crontab
/etc/cron.allow
/etc/cron.d
/etc/cron.deny
/etc/cron.daily
/etc/cron.hourly
/etc/cron.monthly
/etc/cron.weekly
/etc/sudoers
/etc/exports
/etc/anacrontab
/var/spool/cron
/var/spool/cron/crontabs/root
crontab -l
ls -alh /var/spool/cron;
ls -al /etc/ | grep cron
ls -al /etc/cron*
cat /etc/cron*
cat /etc/at.allow
cat /etc/at.deny
cat /etc/cron.allow
cat /etc/cron.deny*

SUID:

El atributo SUID / Setuid es utilizado para establecer ID de usuario durante la ejecución y se encuentra habilitado de forma predeterminada en todas las distribuciones de Linux. Si se ejecuta un archivo con este bit, el propietario ejecutará dicho script o binario con los privilegios del usuario propietario de este fichero a través de la personificación de su uid. Si el propietario del archivo es el usuario root, el uid se cambiará root incluso si fuere ejecutado por otro usuario. El bit SUID está representado por la letra s en la cadena de representación de permisos y atributos de un fichero. A continuación, se lista el comando ejecutado a estos fines:

find / -perm -4000 -type f -exec ls -la {} 2>/dev/null \;
