# Techniques for Local Privilege Escalation in Linux

## Files Containing Passwords

The system files are searched and the results obtained are analyzed in order to identify passwords that are embedded in scripts and configuration files. 

To do this, the command listed below is executed.
```
grep --color=auto -rnw '/' -ie "PASSWORD" --color=always 2> /dev/null
```

## Last Edited Files

A search of the recently edited files is carried out and the results obtained are analyzed. 

For this task, the command listed below is run.
```
find / -mmin -10 2>/dev/null | grep -Ev "^/proc"
```

## Passwords in Memory

The next step is to try to extract memory resident passwords. 

To do this, a search is made for character strings that contain the word PASS within `/dev/mem`. 

The command executed for this analysis is listed below:
```
strings /dev/mem -n10 | grep -i PASS
```

## Information Leakage in Sensitive Files
```
locate password | more
/boot/grub/i386-pc/password.mod
/etc/pam.d/common-password
/etc/pam.d/gdm-password
/etc/pam.d/gdm-password.original
```

## Scheduled Tasks

In order to elevate privileges within the system, an attempt is made to identify files on which you have write permissions with the user usrentlgy. 

These files are normally related to managing scheduled tasks and managing user permissions. 

Below is a list of the audited files:
```
/etc/init.d
/etc/cron*
/etc/crontab
/etc/cron.allow
/etc/cron.d
/etc/cron.deny
/etc/cron.daily
/etc/cron.hourly
/etc/cron.monthly
/etc/cron.weekly
/etc/sudoers
/etc/exports
/etc/anacrontab
/var/spool/cron
/var/spool/cron/crontabs/root
crontab -l
ls -alh /var/spool/cron;
ls -al /etc/ | grep cron
ls -al /etc/cron*
cat /etc/cron*
cat /etc/at.allow
cat /etc/at.deny
cat /etc/cron.allow
cat /etc/cron.deny*
```

## SUID

The `SUID/Setuid` attribute is used to set user IDs at runtime and is enabled by default on all Linux distributions. 

If a file is executed with this bit, the owner will execute said script or binary with the privileges of the user who owns this file through the personification of its uid.

If the owner of the file is the root user, the uid will be changed to root even if it is run by another user. 

The SUID bit is represented by the letter `s` in the string of representation of permissions and attributes of a file. 

The command executed for these purposes is listed below:
```
find / -perm -4000 -type f -exec ls -la {} 2>/dev/null \;
```


# Techniques for Local Privilege Escalation in Windows

## CVEs

- [CVE-2021-41379](https://www.bleepingcomputer.com/news/microsoft/new-windows-zero-day-with-public-exploit-lets-you-become-an-admin/): Exploits system EDGE browser settings, you can found the [PoC binary here](https://github.com/klinix5/InstallerFileTakeOver).
