# Internal Enumeration

The good steps for a scenario where you have a Domain User in Active Directory.

# Tools

- [rpcenum](https://github.com/s4vitar/rpcenum.git)
- [responder](https://github.com/lgandx/Responder)

# RPC Client with null sessions

User without credentials:

`rpcclient -U "" <dc_ip> -N`

User with credentials of AD:
Complete...

# Responder

> Responder is a tool with different capabilities but the most interesting is the ability to set up a rogue samba server and steal NetNTLM hashes.
> 

> By responding to LLMNR/NBT-NS network traffic, adversaries can spoof an authoritative source for name resolution to force communication with an adversary-controlled system.
> 

> Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are components of Microsoft Windows that serve as alternate methods of host identification.
> 
> 
> LLMNR is based on the Domain Name System (DNS) format and allows hosts on the same link-local to perform name resolution for other hosts. 
> 
> NBT-NS identifies systems on a local network by their NetBIOS name.
> 

### Listening Mode (2015)

In order to complete this task, it is good practice to start the responder in analysis mode with the -A option.

`**python3 Responder.py -I eth0 -A**`

This way we can get an overview of normal network traffic and see if there are NACs (Network Access Controls). From this point we can easily exclude them by modifying the `Responder.conf` putting their IP in the `DontRespondTo`. Otherwise, if we want to target a specific IP, we would have to insert them into the `RespondTo`.

### NTLMv1/2 Hashes Capture Mode (2015)

We are now ready to capture some hashes with the following command:

**`python3 Responder.py -I eth0`**

When a client tries to resolve a name that is not in DNS, Responder poisons the LLMNR (Link-Local Multicast Name Resolution), NBT-NS (NetBIOS Name Service), and forges the SMB request to capture the NetNTLMv2 hash .

Once the hash has been obtained, we can proceed to decrypt it or we can retransmit (**PassTheHash**) it to another machine.
