# External Pentesting Network

## Discovering hosts from the outside

This is going to be a **brief section** about how to find **IPs responding** from the **Internet**.

In this situation you have some **scope of IPs** (maybe even several **ranges**) and you just to find **which IPs are responding**.


### ICMP

This is the **easiest** and **fastest** way to discover if a host is up or not. You could try to send some **ICMP** packets and **expect responses**.

The easiest way is just sending an **echo request** and expect from the response. You can do that using a simple `ping` or using `fping` for **ranges**.

You could also use **nmap** to send other types of ICMP packets (this will avoid filters to common ICMP echo request-response).

```
ping -c 3 192.168.1.137    # 1 echo request to a host
fping -c 3 -g 192.168.1.0/24  # Send 3 echo requests to ranges
nmap -PEPM -sP -n 192.168.1.0/24 # Send echo, timestamp requests and subnet mask requests
nmap -Pn -sn 192.168.1.0/24 # Send Ping Scan - disable port scan
```

### TCP Port Discovery

It's very common to find that all kind of ICMP packets are being filtered. Then, all you can do to check if a host is up is **try to find open ports**. Each host has **65535 ports**, so, if you have a "big" scope you **cannot** test if **each port** of each host is open or not, that will take too much time.\
Then, what you need is a **fast port scanner** ([masscan](https://github.com/robertdavidgraham/masscan)) and a list of the **ports more used:**

```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,7001,7002,8080,8443 199.66.11.0/24
```

You could also perform this step with `nmap`, but it slower and somewhat `nmap`has problems identifying hosts up.


nmap -sS 192.168.1.0/24 # Fast simple scan TCP SYN
masscan -e tun0 --open -p1-65535 --max-rate 1000 <IP>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
### ReconFTW

To perform a full recon on single target
```
./reconftw.sh -d target.com -r
```

To perform a subdomains recon on single target
```
./reconftw.sh -d target.com -s
```

To perform a full recon on a list of targets
```
./reconftw.sh -l sites.txt -r -o /output/directory/
```

Perform all steps (whole recon + all attacks)
```
./reconftw.sh -d target.com -a
```

Perform full recon with more time intense tasks (VPS intended only)
```
./reconftw.sh -d target.com -r --deep -o /output/directory/
```

Perform recon in a multi domain target
```
./reconftw.sh -m company -l domains_list.txt -r
```

### BruteSpray

Also, It could be worth it to mention that you can also prepare some **default username** and **passwords lists** and try to **bruteforce services with [https://github.com/x90skysn3k/brutespray](https://github.com/x90skysn3k/brutespray)** 

### Automatic Tools

There are several tools out there that will perform part of the proposed actions against a given scope.

[**https://github.com/yogeshojha/rengine**](https://github.com/yogeshojha/rengine)
[**https://github.com/j3ssie/Osmedeus**](https://github.com/j3ssie/Osmedeus)
[**https://github.com/six2dez/reconftw**](https://github.com/six2dez/reconftw)
[**https://github.com/hackerspider1/EchoPwn**](https://github.com/hackerspider1/EchoPwn) (A little old and not updated)
